
<div class="container">
    <?php foreach (array_reverse($table) as $floor): ?>
    <h2><?= $floor['name']; ?></h2>

    <div class="row floor-row">
        <?php foreach (array_reverse($floor['rooms']) as $index => $room): ?>
        
        <?php
            $free = empty($room['taken']);
            $leavingToday = $room['leaving_today'];
            
            if ($leavingToday){
                $backgroundClass = 'leaving';
            } else {
                $backgroundClass = !$free ? 'taken' : 'free';
            }
        ?>

        <div class="col-lg-1 <?= $backgroundClass; ?>">
            <?php if ($free): ?>

            <p><a title="<? $this->show('Reserve'); ?>" href="<?= $this->createQueryUrl('Site:Reservation@addAction', array('room_id' => $room['id'])); ?>"><?= $room['name']; ?> <br /><small><?= $room['type']; ?></small></a></p>
            <p><? $this->show('Free'); ?></p>

            <?php else: ?>

            <p><?= $room['name']; ?> <?= $room['type']; ?></p>

            <?php if ($leavingToday): ?>
            <p class="leaving"><? $this->show('Leaving today'); ?></p>
            <?php else: ?>
            <a data-button="view" href="<?= $this->url('Site:Reservation@viewTakenAction', $room['id']); ?>" data-toggle="tooltip" title="<?= $this->translate('Remained days - %s', $room['left_days']); ?>"><? $this->show('Taken up to'); ?> <?= $room['departure']; ?></a>
            <?php endif ;?>

            <?php endif; ?>
        </div>
        <?php endforeach; ?>
    </div>

    <?php endforeach; ?>
</div>

<? $this->loadPartial('client-modal'); ?>
